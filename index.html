<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title> Flappy skull ðŸ’€</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{
    background:linear-gradient(180deg,#6ee7b7 0%,#3b82f6 100%);
    display:flex;justify-content:center;align-items:center;
    height:100vh;overflow:hidden;
    font-family:"Poppins",sans-serif;
  }
  canvas{
    border-radius:20px;
    box-shadow:0 8px 25px rgba(0,0,0,0.3);
    touch-action:manipulation;
    background:linear-gradient(180deg,#60a5fa 0%,#93c5fd 60%,#fef9c3 100%);
  }
  @media(max-width:600px){
    canvas{width:200vw;height:70vh;}
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="600"></canvas>

<!-- ðŸŽµ Background & flap sounds -->
<audio id="bgMusic" loop>
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_26b36a8c8b.mp3" type="audio/mpeg">
</audio>
<audio id="flapSound">
  <source src="https://cdn.pixabay.com/download/audio/2023/05/02/audio_8c19ec7d3a.mp3?filename=wing-flap-142329.mp3" type="audio/mpeg">
</audio>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
const bgMusic=document.getElementById("bgMusic");
const flapSound=document.getElementById("flapSound");

let gameState="menu";
const bird={x:80,y:260,w:30,h:30,vel:0,grav:0.18,lift:-5}; // ðŸ’€ slower gravity + slower lift
let pipes=[],frame=0,score=0,high=localStorage.getItem("flappyHigh")||0;

// === DRAW HELPERS ===
function drawGradientSky(){
  const grad=ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0,"#60a5fa");
  grad.addColorStop(1,"#fef9c3");
  ctx.fillStyle=grad;
  ctx.fillRect(0,0,canvas.width,canvas.height);
}
function drawGround(){
  ctx.fillStyle="#d9f99d";
  ctx.fillRect(0,canvas.height-100,canvas.width,100);
}
function drawBird(){
  ctx.font="28px Arial";
  ctx.fillText("ðŸ’€",bird.x,bird.y+25);
}
function drawPipes(){
  ctx.fillStyle="#22c55e";
  pipes.forEach(p=>{
    ctx.fillRect(p.x,p.y,p.w,p.h);
    ctx.fillRect(p.x,p.y+p.h+p.gap,p.w,canvas.height-p.y-p.h-p.gap-100);
  });
}
function drawText(txt,x,y,size=28,color="#fff",bold=true){
  ctx.fillStyle=color;
  ctx.font=(bold?"bold ":"")+size+"px Poppins";
  ctx.fillText(txt,x,y);
}

// === UPDATE FUNCTIONS ===
function updateBird(){
  bird.vel+=bird.grav;
  bird.y+=bird.vel;
  if(bird.y+bird.h>=canvas.height-100){endGame();}
  if(bird.y<0)bird.y=0;
}
function updatePipes(){
  if(frame%120===0){ // fewer pipes
    const topH=Math.random()*150+50;
    pipes.push({x:canvas.width,y:0,h:topH,gap:170,w:80,sc:false}); // thicker poles
  }
  pipes.forEach(p=>{
    p.x-=1.3; // slower horizontal speed
    if(!p.sc && p.x+p.w<bird.x){score++;p.sc=true;}
    if(bird.x+bird.w-5>p.x && bird.x+5<p.x+p.w &&
       (bird.y+5<p.h || bird.y+bird.h-5>p.h+p.gap)){
       endGame();
    }
  });
  pipes=pipes.filter(p=>p.x+p.w>0);
}

// === GAME STATES ===
function endGame(){
  gameState="over";
  bgMusic.pause();
  if(score>high){high=score;localStorage.setItem("flappyHigh",high);}
}
function startGame(){
  gameState="play";
  pipes=[];score=0;frame=0;
  bird.y=260;bird.vel=0;
  bgMusic.currentTime=0;
  bgMusic.play();
}
function drawMenu(){
  drawGradientSky();drawGround();
  drawText("Flappy skull",80,200,32,"#fff");
  drawText("Flappy ðŸ’€",130,250,38,"#fde047");
  const yOffset=Math.sin(Date.now()/300)*6;
  ctx.save();
  ctx.translate(200,320+yOffset);
  ctx.font="32px Arial";
  ctx.fillText("ðŸ’€",0,0);
  ctx.restore();
  drawText("Tap or Press Space to Start",50,400,18,"#fff",false);
}
function drawOver(){
  drawGradientSky();drawGround();drawPipes();drawBird();
  drawText("Game Over",110,260,36,"#fff");
  drawText("Score: "+score,140,310,26);
  drawText("Best: "+high,150,340,26);
  drawText("Tap or Press Space to Restart",30,380,18,"#fff",false);
}
function drawPlay(){
  drawGradientSky();drawPipes();drawGround();drawBird();
  drawText("Score: "+score,10,40,24);
}
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  if(gameState==="menu")drawMenu();
  else if(gameState==="play"){updatePipes();updateBird();drawPlay();frame++;}
  else if(gameState==="over")drawOver();
  requestAnimationFrame(loop);
}

// === CONTROLS ===
function flap(){
  if(gameState==="menu"){startGame();}
  else if(gameState==="play"){bird.vel=bird.lift;flapSound.currentTime=0;flapSound.play();}
  else if(gameState==="over"){startGame();}
}
window.addEventListener("keydown",e=>{if(e.code==="Space")flap();});
canvas.addEventListener("touchstart",flap);

// === START ===
bgMusic.volume=0.3;
loop();
</script>
</body>
</html>

